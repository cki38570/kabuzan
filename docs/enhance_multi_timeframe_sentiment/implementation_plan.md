# 実装計画: マルチタイムフレーム分析と感情分析の統合

株価分析アプリ「Kabuzan」に、マルチタイムフレーム分析（日足・週足）、ニュースに基づくセンチメント分析、および LINE Notify によるシグナル通知機能を実装します。

## 変更内容の概要

### 1. マルチタイムフレーム分析の導入
- **目的**: 大局的なトレンド（週足）を確認した上で、日足でのエントリータイミングを判断できる「鳥の目と虫の目」の分析を実現。
- **データ層**: `DataManager` が日足と週足の両方のデータを取得し、それぞれの時間軸に最適な指標（13/26/52週移動平均など）を計算。
- **UI層**: チャット表示部に「日足 (Daily)」と「週足 (Weekly)」のタブを設け、Plotlyによる高度なインタラクティブ・チャートを表示。

### 2. センチメント分析（ニュース連携）の統合
- **目的**: テクニカル分析だけでなく、直近のニュース感情を投資判断に取り入れ、より精度の高い予測を行う。
- **ニュース取得**: `yfinance` のニュースAPIを使用。効率化のためキャッシュ機能を搭載。
- **AI判定**: Gemini 1.5/2.0 を使用し、ニュース内容からポジティブ・ネガティブを判定。テクニカルと合算して100点満点の総合スコアを算出。

### 3. LINE Notify によるシグナル通知
- **目的**: ユーザーがアプリを開いていない時でも、特定の売買チャンス（RSI売られすぎ、ボリンジャーバンド接触等）を逃さないよう通知する。
- **実装**: `modules/notifications.py` にシグナル検知ロジックを追加し、`modules/line.py` 経由でプッシュ通知を送信。

## 検証計画

### 自動テスト / 動作確認
- 銘柄検索時に、日足と週足それぞれのチャートが正しく表示されることを確認。
- チャートのレンジセレクターが正常に動作することを確認。
- AI分析タブで、ニュース一覧と総合スコアゲージが表示されることを確認。
- LINE Notify のトークンが設定されている場合に、シグナル検知時の通知が届くことをテスト（手動トリガー）。

### マニュアル検証
- さまざまな銘柄（7203, 9984等）で分析を実行し、レポートの整合性を確認。

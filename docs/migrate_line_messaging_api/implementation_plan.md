# LINE Messaging API 実装の柔軟性向上計画 (ID/Secret対応)

ユーザーが取得可能な Channel ID と Channel Secret のみを使用して、自動的に通知が届く仕組みを構築します。

## ユーザーレビューが必要な事項
- **ブロードキャスト配信の使用**:
  - `User ID` を特定せずにメッセージを送るため、「公式アカウントをフォローしている全員（＝自分）」に一斉送信するエンドポイントを使用します。
  - 自分一人で利用している場合はプッシュ通知と同じ感覚で利用可能です。

## 変更内容

### 1. 認証と送信ロジックの強化

#### [MODIFY] [notifications.py](file:///c:/Users/GORO\Desktop\kabuzan\modules\notifications.py)
- **トークン自動取得**: 毎回または一定期間ごとに Channel ID / Secret を用いて短期アクセストークンを取得する関数を追加します。
- **ブロードキャスト方式の採用**: 送信先 (`to`) を指定せず、全フォロワーに届く `v2/bot/message/broadcast` を使用するように `send_line_message` を改良します。これにより `User ID` の設定が不要になります。

## 検証計画

### 手動検証
1. `secrets.toml` に ID と Secret を設定した状態で、「テスト通知」が届くか確認します。
2. トークンの取得に失敗した場合、適切なエラーメッセージ（認証情報の不備など）が UI に表示されるか確認します。
